---
lang: "ja"
title: "Setuid"
description: "Linux の Setuid (SUID) パーミッション、その仕組み、および変更方法について学びます。Linux での安全なファイルアクセスにおける SUID を理解します。"
keywords: "Linux Setuid, SUID, Linux パーミッション，chmod, passwd コマンド，Linux セキュリティ，初心者 Linux, Linux チュートリアル"
---

## Lesson Content

一般ユーザーが何かを行うために昇格されたアクセス権を必要とするケースは多くあります。システム管理者は、ユーザーが保護されたファイルにアクセスするたびに root パスワードを入力するために常にそこにいるわけではないため、この動作を許可するための特別なファイルパーミッションビットがあります。Set User ID (SUID) は、ユーザーがプログラムを自分自身としてではなく、プログラムファイルの所有者として実行することを可能にします。

例を見てみましょう。

パスワードを変更したいとします。簡単ですよね？ `passwd` コマンドを使用するだけです。

```bash
passwd
```

`passwd` コマンドは何をしているのでしょうか？いくつかのファイルを変更していますが、最も重要なのは `/etc/shadow` ファイルを変更していることです。そのファイルを少し見てみましょう。

```bash
$ ls -l /etc/shadow

-rw-r----- 1 root shadow 1134 Dec 1 11:45 /etc/shadow
```

ちょっと待ってください、このファイルは root が所有していますか？root が所有するファイルを変更できるのはどうしてでしょうか？

別のパーミッションセットを見てみましょう。今回は実行したコマンドのものです。

```bash
$ ls -l /usr/bin/passwd

-rwsr-xr-x 1 root root 47032 Dec 1 11:45 /usr/bin/passwd
```

ここに新しいパーミッションビット「**s**」があることに気づくでしょう。このパーミッションビットが SUID です。ファイルにこのパーミッションが設定されている場合、プログラムを起動したユーザーは、ファイル所有者のパーミッションと実行パーミッション（この場合は root）も取得できます。つまり、ユーザーが `passwd` コマンドを実行している間は、root として実行していることになります。

そのため、`passwd` コマンドを実行すると、`/etc/shadow` のような保護されたファイルにアクセスできるのです。このビットを削除すると、`/etc/shadow` を変更できなくなり、したがってパスワードを変更できなくなることがわかるでしょう。

### Modifying SUID

通常のパーミッションと同様に、SUID パーミッションを変更する方法は 2 つあります。

_Symbolic way:_

```bash
sudo chmod u+s myfile
```

_Numerical way:_

```bash
sudo chmod 4755 myfile
```

ご覧のとおり、SUID は 4 で表され、パーミッションセットの前に付加されます。SUID が「大文字の**S**」で表されることもあります。これは、同じことを意味しますが、実行パーミッションがないことを示します。

## Exercise

`/etc/passwd` のパーミッションを詳しく見てください。他に何か気づくことはありますか？SUID が有効になっているファイルも簡単に区別できます。

## Quiz Question

SUID を表す数字は何ですか？

## Quiz Answer

4
