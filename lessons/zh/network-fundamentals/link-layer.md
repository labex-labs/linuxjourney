---
index: 8
lang: "zh"
title: "链路层"
meta_title: "链路层 - 网络基础"
meta_description: "了解 TCP/IP 中的链路层、ARP 如何解析 MAC 地址以及数据包遍历。通过此 Linux 网络教程了解网络基础知识。"
meta_keywords: "链路层，ARP, TCP/IP, MAC 地址，网络基础知识，Linux 网络，初学者，教程"
---

## Lesson Content

TCP/IP 模型的底部是链路层。这一层是硬件特定的。

在链路层，我们的数据包再次被封装成一个称为帧的东西。帧头附加了我们主机的源和目标 MAC 地址、校验和以及数据包分隔符，以便接收方可以知道数据包何时结束。

幸运的是，我们在同一个网络中，所以我们的数据包不必传输太远。首先，链路层将我的源 MAC 地址附加到帧头，但它也需要知道 Patty 的 MAC 地址。它怎么知道呢？既然它不在互联网上，我怎么找到它呢？我们使用 ARP！

### ARP（地址解析协议）

ARP 查找与 IP 地址关联的 MAC 地址。ARP 在同一网络内使用。如果 Patty 不在同一个网络中，我们将使用路由系统来确定接收数据包的下一个路由器，一旦我们在同一个网络中，我们就可以使用 ARP。

一旦我们在同一个网络中，系统首先使用 ARP 查找表，该表存储有关哪些 IP 地址与哪些 MAC 地址关联的信息。如果该值不存在，则使用 ARP。然后系统将使用 ARP 协议向网络发送广播消息，以查找哪个主机拥有 IP 10.10.1.4。广播消息是一种特殊消息，发送到网络上的所有主机（恰如其名，用于发送广播）。任何具有请求 IP 地址的机器都将回复一个包含 IP 地址和 MAC 地址的 ARP 数据包。

现在我们拥有了所有必要的数据——IP 地址和 MAC 地址——我们的链路层通过我们的网络接口卡将此帧转发到下一个设备，并找到 Patty 的网络。这一步比我刚才解释的要复杂一些，但我们将在路由课程中讨论更多细节。

就是这样：一个简单（或不那么简单）的数据包在 TCP/IP 层中的遍历。请记住，数据包不会像这样单向传输。我们甚至还没有到达 Patty 的网络！在网络中传输时，在发送或接收任何数据之前，它至少需要两次通过 TCP/IP 模型。实际上，这个数据包的样子会是这样的：

### 数据包遍历

1. Pete 给 Patty 发送一封电子邮件：此数据被发送到传输层。
2. 传输层将数据封装到 TCP 或 UDP 头部中以形成一个段。该段附加目标和源 TCP 或 UDP 端口，然后该段被发送到网络层。
3. 网络层将 TCP 段封装在 IP 数据包中；它附加源和目标 IP 地址。然后它将数据包路由到链路层。
4. 数据包然后到达 Pete 的物理硬件并被封装在一个帧中。源和目标 MAC 地址被添加到帧中。
5. Patty 通过她的物理层接收此数据帧并检查每个帧的数据完整性，然后解封装帧内容并将 IP 数据包发送到网络层。
6. 网络层读取数据包以查找先前附加的源和目标 IP。它检查其 IP 是否与目标 IP 相同，确实如此！它解封装数据包并将段发送到传输层。
7. 传输层解封装段，检查 TCP 或 UDP 端口号，并根据这些端口号与应用层建立连接。
8. 应用层从传输层接收指定端口上的数据，并以最终电子邮件消息的形式呈现给 Patty。

## Exercise

熟能生巧！以下是一些动手实验，以巩固您对链路层、MAC 地址和 ARP 的理解：

1. **[在 Linux 中识别 MAC 和 IP 地址](https://labex.io/zh/labs/linux-identify-mac-and-ip-addresses-in-linux-592731)** - 练习使用 `ip a` 命令在 Linux 系统上识别网络寻址信息，包括 MAC 地址。
2. **[在 Linux 中使用 ping 和 arp 探索网络层交互](https://labex.io/zh/labs/linux-explore-network-layer-interaction-with-ping-and-arp-in-linux-592746)** - 了解 `ping` 和 `arp` 命令如何协同工作以将 IP 地址解析为 MAC 地址，并理解网络层交互。
3. **[在 Linux 中使用 tcpdump 分析以太网帧](https://labex.io/zh/labs/linux-analyze-ethernet-frames-with-tcpdump-in-linux-592765)** - 获得捕获和检查以太网帧（包括 MAC 地址）的实践经验，以理解低级网络通信。

这些实验将帮助您在实际场景中应用概念，并增强对链路层网络基础知识的信心。

## Quiz Question

在同一网络中用于查找 MAC 地址的是什么？

## Quiz Answer

ARP
